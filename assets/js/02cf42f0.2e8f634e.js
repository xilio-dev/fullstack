"use strict";(self.webpackChunkxilio=self.webpackChunkxilio||[]).push([[278],{5404:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>s});var r=n(6672);const l={},u=r.createContext(l);function a(e){const t=r.useContext(u);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),r.createElement(u.Provider,{value:t},e.children)}},8402:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"base/Java\u57fa\u7840/\u5e76\u53d1\u7f16\u7a0b/CompletableFuture","title":"CompletableFuture","description":"\u6848\u4f8b","source":"@site/docs/base/Java\u57fa\u7840/\u5e76\u53d1\u7f16\u7a0b/CompletableFuture.md","sourceDirName":"base/Java\u57fa\u7840/\u5e76\u53d1\u7f16\u7a0b","slug":"/base/Java\u57fa\u7840/\u5e76\u53d1\u7f16\u7a0b/CompletableFuture","permalink":"/fullstack/docs/base/Java\u57fa\u7840/\u5e76\u53d1\u7f16\u7a0b/CompletableFuture","draft":false,"unlisted":false,"editUrl":"https://github.com/xilio-dev/fullstack/tree/main/docs/base/Java\u57fa\u7840/\u5e76\u53d1\u7f16\u7a0b/CompletableFuture.md","tags":[],"version":"current","frontMatter":{},"sidebar":"baseSidebar","previous":{"title":"\u4ecb\u7ecd","permalink":"/fullstack/docs/base/Java\u57fa\u7840/\u4ecb\u7ecd"},"next":{"title":"\u6570\u7ec4\u62f7\u8d1d\u6027\u80fd\u4f18\u5316","permalink":"/fullstack/docs/base/Java\u57fa\u7840/\u6570\u7ec4/\u6570\u7ec4\u62f7\u8d1d\u6027\u80fd\u4f18\u5316"}}');var l=n(3420),u=n(5404);const a={},s=void 0,o={},c=[{value:"\u6848\u4f8b",id:"\u6848\u4f8b",level:2},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:3},{value:"\u7ec4\u5408\u591a\u4e2a\u5f02\u6b65\u4efb\u52a1+\u5408\u5e76\u7ed3\u679c",id:"\u7ec4\u5408\u591a\u4e2a\u5f02\u6b65\u4efb\u52a1\u5408\u5e76\u7ed3\u679c",level:3},{value:"\u4efb\u52a1\u94fe\u5f0f\u8c03\u7528",id:"\u4efb\u52a1\u94fe\u5f0f\u8c03\u7528",level:3},{value:"\u5e76\u884c\u6267\u884c\u591a\u4e2a\u4efb\u52a1",id:"\u5e76\u884c\u6267\u884c\u591a\u4e2a\u4efb\u52a1",level:3},{value:"\u5f02\u5e38\u5904\u7406",id:"\u5f02\u5e38\u5904\u7406",level:3}];function i(e){const t={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,u.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.h2,{id:"\u6848\u4f8b",children:"\u6848\u4f8b"}),"\n",(0,l.jsx)(t.h3,{id:"\u57fa\u672c\u4f7f\u7528",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,l.jsx)(t.p,{children:"1\u3001\u6267\u884c\u5f02\u6b65\u65e0\u8fd4\u56de\u503c\u4efb\u52a1"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-java",children:"CompletableFuture<Void> future = CompletableFuture.runAsync(() -> {\n    System.out.println(Thread.currentThread().getName());\n});\n"})}),"\n",(0,l.jsx)(t.p,{children:"2\u3001\u5f02\u6b65\u6267\u884c\u5e26\u8fd4\u56de\u503c\u7684\u4efb\u52a1"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-java",children:'CompletableFuture<String> future = CompletableFuture.supplyAsync(() -> {\n    System.out.println(Thread.currentThread().getName());\n    return "hello";\n});\nSystem.out.println(future.get()); //out:hello\n'})}),"\n",(0,l.jsx)(t.p,{children:"3\u3001\u83b7\u53d6\u7ed3\u679c\n#get\uff1a\u6709\u4e00\u573a\uff0c\u4f1a\u963b\u585e\uff0c\u76f4\u5230\u6709\u7ed3\u679c\u624d\u4f1a\u505c\u6b62\u963b\u585e\n#getNow: \u65e0\u5f02\u5e38\uff0c\u4e0d\u963b\u585e\uff0c\u6709\u7ed3\u679c\u7acb\u5373\u8fd4\u56de\uff0c\u5982\u679c\u6ca1\u6709\u7ed3\u679c\uff0c\u9700\u8981\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u624d\u80fd\u591f\u518d\u6b21\u83b7\u53d6\u771f\u6b63\u7684\u7ed3\u679c\uff0c\u4e14\u5f53\u524d\u8fd4\u56de\u9ed8\u8ba4\u503c\u3002"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-java",children:'// \u963b\u585e\u83b7\u53d6\u7ed3\u679c\nString result = future.get();\n// \u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\u83b7\u53d6\u7ed3\u679c\nString resultWithTimeout = future.get(1, TimeUnit.SECONDS);\n// \u975e\u963b\u585e\u83b7\u53d6\u7ed3\u679c\uff08\u5982\u679c\u5b8c\u6210\u5219\u8fd4\u56de\uff0c\u5426\u5219\u8fd4\u56de\u9ed8\u8ba4\u503c\uff09\nString resultOrElse = future.getNow("\u9ed8\u8ba4\u503c");\n'})}),"\n",(0,l.jsx)(t.h3,{id:"\u7ec4\u5408\u591a\u4e2a\u5f02\u6b65\u4efb\u52a1\u5408\u5e76\u7ed3\u679c",children:"\u7ec4\u5408\u591a\u4e2a\u5f02\u6b65\u4efb\u52a1+\u5408\u5e76\u7ed3\u679c"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-java",children:'CompletableFuture<String> future1 = CompletableFuture.supplyAsync(() -> "hello");\nCompletableFuture<String> future2 = CompletableFuture.supplyAsync(() -> "world");\n//\u7b49\u5f85\u4e24\u4e2a\u90fd\u5b8c\u6210\u7136\u540e\u7ec4\u5408\u7ed3\u679c\nfuture1.thenCombine(future2, (s1, s2) -> s1 + " " + s2)//\u7ec4\u5408\u591a\u4e2a\u4efb\u52a1\n        .thenAccept(System.out::println);//out: helloworld\n'})}),"\n",(0,l.jsx)(t.h3,{id:"\u4efb\u52a1\u94fe\u5f0f\u8c03\u7528",children:"\u4efb\u52a1\u94fe\u5f0f\u8c03\u7528"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-java",children:'CompletableFuture.supplyAsync(() -> {\n    try {\n        Thread.sleep(1000);\n    } catch (InterruptedException e) {\n        throw new RuntimeException(e);\n    }\n    return "hello";\n}).thenApply(s -> s + " world")//\u540c\u6b65\u7ec4\u5408\u4e0a\u4e00\u6b65\u7684\u7ed3\u679c\n.thenApplyAsync(s -> s + "!")//\u5f02\u6b65\u7ec4\u5408\u4e0a\u4e00\u6b65\u7684\u7ed3\u679c\n.thenAccept(System.out::println);//\u6d88\u8d39\u4efb\u52a1 out\uff1ahello world! \n'})}),"\n",(0,l.jsx)(t.h3,{id:"\u5e76\u884c\u6267\u884c\u591a\u4e2a\u4efb\u52a1",children:"\u5e76\u884c\u6267\u884c\u591a\u4e2a\u4efb\u52a1"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-java",children:'CompletableFuture<String> future1 = CompletableFuture.supplyAsync(() -> {\n    try {Thread.sleep(1000);} catch (InterruptedException ignored) {}\n    return "result1";\n});\nCompletableFuture<String> future2 = CompletableFuture.supplyAsync(() -> {\n    try {Thread.sleep(1500);} catch (InterruptedException ignored) {}\n    return "result2";\n});CompletableFuture<String> future3 = CompletableFuture.supplyAsync(() -> {\n    try {Thread.sleep(500);} catch (InterruptedException ignored) {}\n    return "result3";\n});\n//\u7b49\u5f85\u6240\u6709\u4efb\u52a1\u90fd\u5b8c\u6210\nCompletableFuture<Void> futures = CompletableFuture.allOf(future1, future2, future3);\nfutures.thenRun(() -> {\n    System.out.println("\u6240\u6709\u4efb\u52a1\u5df2\u7ecf\u6267\u884c\u5b8c\u6210\uff5e");\n    try {\n        System.out.println(future1.get());\n        System.out.println(future2.get());\n        System.out.println(future3.get());\n    }  catch (Exception e) {\n        e.printStackTrace();\n    }\n});\n'})}),"\n",(0,l.jsx)(t.h3,{id:"\u5f02\u5e38\u5904\u7406",children:"\u5f02\u5e38\u5904\u7406"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-java",children:'CompletableFuture.supplyAsync(() -> {\n    if (new Random().nextBoolean()) {\n        throw new RuntimeException("\u51fa\u9519\u4e86");\n    }\n    return "\u7ed3\u679c";\n}).exceptionally(e -> {\n    System.out.println("error" + e.getMessage());\n    return "\u9ed8\u8ba4\u7ed3\u679c";\n}).thenAccept(System.out::println);\n'})})]})}function p(e={}){const{wrapper:t}={...(0,u.R)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(i,{...e})}):i(e)}}}]);