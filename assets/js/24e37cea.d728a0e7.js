"use strict";(self.webpackChunkxilio=self.webpackChunkxilio||[]).push([[49],{3774:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>i});var o=r(6672);const s={},a=o.createContext(s);function c(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),o.createElement(a.Provider,{value:n},e.children)}},5286:(e,n,r)=>{r.d(n,{A:()=>o});const o=r.p+"assets/images/img1-1cbbfe40c34d3d089d25a209b1f88c04.png"},7909:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>o,toc:()=>t});const o=JSON.parse('{"id":"base/Zookeeper/\u5b89\u88c5","title":"\u73af\u5883\u642d\u5efa","description":"\u4e0b\u9762\u5b89\u88c5\u6559\u7a0b\u9002\u7528\u4e8eLinux\u3001Mac\u7cfb\u7edf","source":"@site/docs/base/Zookeeper/\u5b89\u88c5.md","sourceDirName":"base/Zookeeper","slug":"/base/Zookeeper/\u5b89\u88c5","permalink":"/xilio-doc/docs/base/Zookeeper/\u5b89\u88c5","draft":false,"unlisted":false,"editUrl":"https://github.com/xilio-dev/xilio-doc/tree/main/docs/base/Zookeeper/\u5b89\u88c5.md","tags":[{"inline":true,"label":"Java","permalink":"/xilio-doc/docs/tags/java"},{"inline":true,"label":"zookeeper","permalink":"/xilio-doc/docs/tags/zookeeper"},{"inline":true,"label":"\u5fae\u670d\u52a1","permalink":"/xilio-doc/docs/tags/\u5fae\u670d\u52a1"},{"inline":true,"label":"\u5206\u5e03\u5f0f","permalink":"/xilio-doc/docs/tags/\u5206\u5e03\u5f0f"}],"version":"current","frontMatter":{"title":"\u73af\u5883\u642d\u5efa","tags":["Java","zookeeper","\u5fae\u670d\u52a1","\u5206\u5e03\u5f0f"]},"sidebar":"baseSidebar","previous":{"title":"\u4ecb\u7ecd","permalink":"/xilio-doc/docs/base/Zookeeper/\u4ecb\u7ecd"},"next":{"title":"\u4ecb\u7ecd","permalink":"/xilio-doc/docs/base/intro"}}');var s=r(3420),a=r(3774);const c={title:"\u73af\u5883\u642d\u5efa",tags:["Java","zookeeper","\u5fae\u670d\u52a1","\u5206\u5e03\u5f0f"]},i="\u4ecb\u7ecd",l={},t=[{value:"\u5355\u673a\u73af\u5883\u642d\u5efa",id:"\u5355\u673a\u73af\u5883\u642d\u5efa",level:2},{value:"\u96c6\u7fa4\u73af\u5883\u642d\u5efa",id:"\u96c6\u7fa4\u73af\u5883\u642d\u5efa",level:2},{value:"\u5355\u670d\u52a1\u5668\u642d\u5efa\u96c6\u7fa4\uff08\u751f\u4ea7\u4e0d\u63a8\u8350\uff09",id:"\u5355\u670d\u52a1\u5668\u642d\u5efa\u96c6\u7fa4\u751f\u4ea7\u4e0d\u63a8\u8350",level:3},{value:"Java\u7f16\u7a0b",id:"java\u7f16\u7a0b",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u4ecb\u7ecd",children:"\u4ecb\u7ecd"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0b\u9762\u5b89\u88c5\u6559\u7a0b\u9002\u7528\u4e8eLinux\u3001Mac\u7cfb\u7edf"}),"\n",(0,s.jsxs)(n.p,{children:["\u5b98\u7f51\u5b89\u88c5\u6559\u7a0b\uff1a",(0,s.jsx)(n.a,{href:"https://zookeeper.apache.org/doc/r3.9.3/zookeeperStarted.html",children:"https://zookeeper.apache.org/doc/r3.9.3/zookeeperStarted.html"})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u6ce8\u610f\uff1a\u9700\u8981\u63d0\u524d\u5b89\u88c5java\u73af\u5883"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u5355\u673a\u73af\u5883\u642d\u5efa",children:"\u5355\u673a\u73af\u5883\u642d\u5efa"}),"\n",(0,s.jsxs)(n.p,{children:["1\u3001\u9996\u5148\u8fdb\u5165",(0,s.jsx)(n.strong,{children:"conf"}),"\u76ee\u5f55\uff0c\u4ece",(0,s.jsx)(n.strong,{children:"zoo_sample.cfg"}),"\u590d\u5236\u4e00\u4e2a\u526f\u672c\u4e3a",(0,s.jsx)(n.strong,{children:"zoo.cfg"}),"\uff0c",(0,s.jsx)(n.strong,{children:"3.9.3"}),"\u7248\u672c\u5185\u90e8\u9ed8\u8ba4\u4f1a\u4f7f\u7528",(0,s.jsx)(n.strong,{children:"8080"}),"\u548c",(0,s.jsx)(n.strong,{children:"2181"}),"\u7aef\u53e3\uff0c\u5b89\u88c5\u524d\u9700\u8981\u63d0\u524d\u68c0\u67e5\u662f\u5426\u6709\u8fdb\u7a0b\u5360\u7528\u8be5\u7aef\u53e3\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"cp /conf/\u4ecezoo_sample.cfg zoo.cfg\n"})}),"\n",(0,s.jsx)(n.p,{children:"2\u3001\u8fdb\u5165/bin\u76ee\u5f55\uff0c\u6267\u884c\u4e0b\u9762\u547d\u4ee4\u542f\u52a8zookeeper\u670d\u52a1\u7aef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"./zkServer.sh start\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u505c\u6b62\u670d\u52a1\uff1a ./zkServer.sh stop"}),"\n",(0,s.jsx)(n.p,{children:"3\u3001\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u542f\u52a8\u4e00\u4e2a\u57fa\u4e8e\u7ec8\u7aef\u7684\u5ba2\u6237\u7aef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"./zkCli.sh\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff081\uff09\u67e5\u770b\u6240\u6709\u8282\u70b9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"ls /\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff082\uff09\u521b\u5efa\u4e00\u4e2a\u8282\u70b9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"create /user admin\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff083\uff09\u83b7\u53d6\u8282\u70b9\u4fe1\u606f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"get -s /user\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uff084\uff09\u5220\u9664\u8282\u70b9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"delete /user\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u96c6\u7fa4\u73af\u5883\u642d\u5efa",children:"\u96c6\u7fa4\u73af\u5883\u642d\u5efa"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u672c\u6b21\u642d\u5efa\u6d4b\u8bd5\u7248\u672c\uff1a3.9.3"}),"\n",(0,s.jsx)(n.p,{children:"\u5de5\u4f5c\u76ee\u5f55\uff1agroups"}),"\n",(0,s.jsx)(n.p,{children:"\u64cd\u4f5c\u7cfb\u7edf\u8981\u6c42\uff1aLinux\u6216Mac"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u5355\u670d\u52a1\u5668\u642d\u5efa\u96c6\u7fa4\u751f\u4ea7\u4e0d\u63a8\u8350",children:"\u5355\u670d\u52a1\u5668\u642d\u5efa\u96c6\u7fa4\uff08\u751f\u4ea7\u4e0d\u63a8\u8350\uff09"}),"\n",(0,s.jsxs)(n.p,{children:["1\u3001\u62f7\u8d1d\u4e09\u4efdzookeeper\u670d\u52a1\n",(0,s.jsx)(n.img,{alt:"img1.png",src:r(5286).A+"",width:"531",height:"158"})]}),"\n",(0,s.jsx)(n.p,{children:"2\u3001\u521b\u5efa3\u4e2a\u6570\u636e\u6587\u4ef6\u5939"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"sudo mkdir /var/lib/zookeeper/data/zk1\nsudo mkdir /var/lib/zookeeper/data/zk2\nsudo mkdir /var/lib/zookeeper/data/zk3\n\nsudo chmod -R 777 /var/lib/zookeeper\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u521b\u5efamyid\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'echo "1" > /var/lib/zookeeper/data/zk1/myid\necho "2" > /var/lib/zookeeper/data/zk2/myid\necho "3" > /var/lib/zookeeper/data/zk3/myid\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u6ce8\u610f\uff1a\u5199\u5165\u76841\u30012\u30013\u9700\u8981\u548c\u4e0b\u9762\u914d\u7f6e\u5206\u949f\u7684server.[id]\u4e00\u4e00\u5bf9\u5e94\u3002\n3\u3001\u7f16\u8f91\u6bcf\u4e2a\u8282\u70b9\u7684\u914d\u7f6e\u6587\u4ef6\nzoo-node1/conf/zoo.cfg"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\ndataDir=/var/lib/zookeeper/data/zk1\ntickTime=2000\ninitLimit=5\nsyncLimit=2\nclientPort=2181\nadmin.serverPort=8081\nserver.1=localhost:2888:3888\nserver.2=localhost:2889:3889\nserver.3=localhost:2890:3890\n"})}),"\n",(0,s.jsx)(n.p,{children:"zoo-node2/conf/zoo.cfg"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\ntickTime=2000\ndataDir=/var/lib/zookeeper/data/zk2\ninitLimit=5\nsyncLimit=2\nclientPort=2182\nadmin.serverPort=8082\nserver.1=localhost:2888:3888\nserver.2=localhost:2889:3889\nserver.3=localhost:2890:3890\n"})}),"\n",(0,s.jsx)(n.p,{children:"zoo-node3/conf/zoo.cfg"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\ntickTime=2000\ndataDir=/var/lib/zookeeper/data/zk3\ninitLimit=5\nsyncLimit=2\nclientPort=2183\nadmin.serverPort=8083\nserver.1=localhost:2888:3888\nserver.2=localhost:2889:3889\nserver.3=localhost:2890:3890\n"})}),"\n",(0,s.jsxs)(n.p,{children:["4\u3001\u7f16\u5199\u4e00\u952e\u542f\u52a8\u811a\u672c\u5e76\u542f\u52a8\n\u5728group\u76ee\u5f55\u4e0b\u5199\u4e2a\u6700\u7b80\u5355\u7684\u96c6\u7fa4\u542f\u52a8\u811a\u672c",(0,s.jsx)(n.strong,{children:"stat-group.sh"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'#!/bin/bash\n./zoo-node1/bin/zkServer.sh start\n./zoo-node2/bin/zkServer.sh start\n./zoo-node3/bin/zkServer.sh start\necho "ZooKeeper \u96c6\u7fa4\u5df2\u542f\u52a8 "\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u542f\u52a8\u96c6\u7fa4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"./stat-group.sh\n"})}),"\n",(0,s.jsx)(n.p,{children:"5\u3001\u9a8c\u8bc1\u96c6\u7fa4\u642d\u5efa\u7ed3\u679c\n\u53ef\u4ee5\u68c0\u67e5\u4e0b\u9762\u7aef\u53e3\u662f\u5426\u88ab\u5360\u7528\u9a8c\u8bc1\u96c6\u7fa4\u662f\u5426\u542f\u52a8\u6210\u529f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"lsof -i:2181\nlsof -i:2182\nlsof -i:2183\nlsof -i:8081\nlsof -i:8082\nlsof -i:8083\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u76ee\u5f55groups\u4e0b\u6267\u884c\u4e0b\u9762\u547d\u4ee4\u9a8c\u8bc1\u96c6\u7fa4\u542f\u52a8\u72b6\u6001"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"./zoo-node1/bin/zkServer.sh status\n./zoo-node2/bin/zkServer.sh status\n./zoo-node2/bin/zkServer.sh status\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u8fde\u63a5\u96c6\u7fa4\u8282\u70b9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"./zoo-node1/bin/zkCli.sh\n./zoo-node2/bin/zkCli.sh\n./zoo-node3/bin/zkCli.sh\n"})}),"\n",(0,s.jsx)(n.h2,{id:"java\u7f16\u7a0b",children:"Java\u7f16\u7a0b"}),"\n",(0,s.jsxs)(n.p,{children:["\u91c7\u7528curator\u5ba2\u6237\u7aef\uff1a",(0,s.jsx)(n.a,{href:"https://curator.apache.org/docs/about",children:"https://curator.apache.org/docs/about"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.apache.curator</groupId>\n    <artifactId>curator-recipes</artifactId>\n    <version>5.8.0</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.curator</groupId>\n    <artifactId>curator-framework</artifactId>\n    <version>5.8.0</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.curator</groupId>\n    <artifactId>curator-client</artifactId>\n    <version>5.8.0</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.curator</groupId>\n    <artifactId>curator-x-discovery</artifactId>\n    <version>5.8.0</version>\n</dependency>\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u4e2a\u7b80\u5355\u7684\u96c6\u7fa4\u6848\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'import org.apache.curator.framework.CuratorFramework;\nimport org.apache.curator.framework.CuratorFrameworkFactory;\nimport org.apache.curator.retry.ExponentialBackoffRetry;\nimport org.apache.zookeeper.data.Stat;\n\npublic class CuratorDemo {\n\n    public static void main(String[] args) throws Exception {\n        CuratorFramework client = CuratorFrameworkFactory.\n                builder().connectString("localhost:2181," +\n                        "localhost:2182,localhost:2183").\n                sessionTimeoutMs(4000).retryPolicy(new\n                        ExponentialBackoffRetry(1000, 3)).\n                namespace("").build();\n        client.start();\n        Stat stat = new Stat();\n        //\u521b\u5efa\u8282\u70b9\n        client.create().creatingParentsIfNeeded().forPath("/users", "admin".getBytes());\n        //\u67e5\u8be2\u8282\u70b9\u6570\u636e\n        byte[] bytes = client.getData().storingStatIn(stat).forPath("/users");\n        System.out.println(new String(bytes));\n        client.close();\n    }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);